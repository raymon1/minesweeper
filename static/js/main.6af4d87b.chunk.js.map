{"version":3,"sources":["constants.js","components/DigitalCounter.jsx","components/Scoreboard.jsx","components/ContextMenuHandler.js","components/Cell.jsx","components/MinesweeperGrid.jsx","components/getNewGrid.js","components/Minesweeper.jsx","hooks/useTimer.jsx","App.js","reportWebVitals.js","index.js"],"names":["gameStatuses","levels","id","text","height","width","minesCount","DigitalCounter","props","str","value","className","padStart","Scoreboard","minesLeft","onChange","e","levelChangeHandler","target","level","map","l","GameStatus","status","gameStatus","onClickHandler","resetHandler","isClicking","timer","onClick","ContextMenuHandler","callback","onTouchStart","contextMenuPossible","longPressCountdown","setTimeout","onTouchMove","clearTimeout","onTouchCancel","onTouchEnd","onContextMenu","preventDefault","this","Cell","cell","data","isCovered","number","isMine","neighboringMines","mine","content","flagged","clickedMine","ctxMenuHandler","_","handleRightClick","handleLeftClick","MinesweeperGrid","useState","grid","setGrid","refresh","setRefresh","cellGotClicked","x","y","gameOver","newGrid","r","c","hasWon","setGameEnd","cellGotFlagged","reduce","a","queue","k","length","n","shift","i","Math","max","min","j","push","uncoverEmptyGrid","flagsSetGrid","getNewGrid","mines","calcNneighboringMines","count","setneighboringMines","m","rand","floor","random","i1","j1","randomize","addMines","getNewCells","Minesweeper","setLevel","setMinesLeft","setGameStatus","setIsClicking","isActive","reset","setTimer","useEffect","interval","useTimer","newLevelId","onMouseDown","onMouseUp","onMouseLeave","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById","console","log"],"mappings":"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","file":"static/js/main.6af4d87b.chunk.js","sourcesContent":["\nexport const gameStatuses = {\n    notStarted: \"notStarted\",\n    running: \"running\",\n    won: \"won\",\n    lost: \"lost\"\n}\n\nexport const levels = [\n    { id: 0, text: \"Beginner\", height: 10, width: 10, minesCount: 10 },\n    { id: 1, text: \"Intermediate\", height: 16, width: 16, minesCount: 44 },\n    { id: 2, text: \"Expert\", height: 30, width: 30, minesCount: 100 },\n]","import React from 'react';\nimport './Scoreboard.component.css';\n\n\nexport function DigitalCounter(props) {\n    const str = \"\" + props.value\n    return (<div className=\"digital-counter\">{str.padStart(3, '0')}</div>);\n}\n\nexport default DigitalCounter;","import React from 'react';\nimport { gameStatuses, levels } from '../constants';\nimport { DigitalCounter } from './DigitalCounter';\n\n\n\nexport function Scoreboard(props) {\n    return (\n        <div className=\"scoreboard\">\n            <DigitalCounter value={props.minesLeft} />\n            <div>\n                <div className=\"select-wrap\">\n                    <select onChange={(e) => props.levelChangeHandler(e.target.value)} value={props.level}>\n                        { levels.map(l => (<option key={l.id} value={l.id}> {l.text} </option>)) }\n                    </select>\n                </div>\n                <GameStatus status={props.gameStatus} onClickHandler={props.resetHandler} isClicking={props.isClicking} />       \n            </div>\n            <DigitalCounter value={props.timer} />\n        </div>\n    );\n}\n\nexport default Scoreboard;\n\nexport function GameStatus(props) {\n    function getStatusEmoji(status) {\n        if (status === gameStatuses.lost) {\n            return 'ðŸ˜ž';\n        } else if (status === gameStatuses.won) {\n            return 'ðŸ˜Ž';\n        } else {\n            return 'ðŸ˜Š'\n        }\n    }\n\n    return (\n        <button className=\"reset\" onClick={props.onClickHandler}>\n            { props.isClicking ? 'ðŸ˜²' : getStatusEmoji(props.status) }\n        </button>\n    );\n}\n","const longPressDuration = 610;\n\nexport default class ContextMenuHandler {\n    constructor(callback) {\n        this.callback = callback;\n        this.longPressCountdown = null;\n        this.contextMenuPossible = false;\n    }\n\n    onTouchStart = e => {\n        this.contextMenuPossible = true;\n\n        this.longPressCountdown = setTimeout(() => {\n            this.contextMenuPossible = false;\n            this.callback(e);\n        }, longPressDuration);\n    };\n\n    onTouchMove = e => {\n        clearTimeout(this.longPressCountdown);\n    };\n\n    onTouchCancel = e => {\n        this.contextMenuPossible = false;\n        clearTimeout(this.longPressCountdown);\n    };\n\n    onTouchEnd = e => {\n        this.contextMenuPossible = false;\n        clearTimeout(this.longPressCountdown);\n    };\n\n    onContextMenu = e => {\n        this.contextMenuPossible = false;\n\n        clearTimeout(this.longPressCountdown);\n\n        this.callback(e);\n        e.preventDefault();\n    };\n}\n","import React from 'react';\nimport ContextMenuHandler from \"./ContextMenuHandler\";\n\nexport function Cell(props) {\n    const cell = props.data.isCovered ? 'cell' : 'uncovered-cell';\n    const number = !props.data.isCovered && !props.isMine ? `cell-${props.data.neighboringMines}` : '';\n    const mine = !props.data.isCovered && props.isMine ? 'cell-mine' : '';\n    const content = props.data.isCovered ? \n        (props.data.flagged ? 'ðŸš©' : '') : (props.data.isMine ? 'ðŸ’£' : props.data.neighboringMines > 0 ? props.data.neighboringMines : ''); \n    const clickedMine = props.data.clickedMine ? 'clicked-mine' : ''\n\n    const ctxMenuHandler = new ContextMenuHandler(_ => props.handleRightClick(props.data));\n\n    return (\n        <button \n            className={`${cell} ${number} ${mine} ${clickedMine}`}\n            onClick={() => props.handleLeftClick(props.data)}\n            onContextMenu={ctxMenuHandler.onContextMenu}\n            onTouchStart={ctxMenuHandler.onTouchStart}\n            onTouchCancel={ctxMenuHandler.onTouchCancel}\n            onTouchEnd={ctxMenuHandler.onTouchEnd}\n            onTouchMove={ctxMenuHandler.onTouchMove}>\n                { content }\n        </button>\n    );\n}\n\nexport default Cell;\n","import React, { useState } from 'react';\nimport { Cell } from './Cell';\nimport { gameStatuses } from '../constants';\n\n\nexport function MinesweeperGrid(props) {\n    const [grid, setGrid] = useState(props.grid);\n    const [refresh, setRefresh] = useState(props.refresh);\n\n    if(refresh !== props.refresh) {\n        setRefresh(props.refresh);\n        setGrid(props.grid);\n    }\n\n    function handleRightClick(cell) {\n        props.cellGotClicked();\n\n        const [x, y] = [cell.x, cell.y];\n\n        if (!grid[x][y].isCovered || props.gameOver)\n            return;\n\n        const newGrid = grid.map(r => r.map(c => ({...c})));\n\n        newGrid[x][y].flagged = !newGrid[x][y].flagged;\n        \n        if(hasWon(newGrid)) {\n            props.setGameEnd(gameStatuses.won);\n        }\n\n        setGrid(newGrid);\n        props.cellGotFlagged(newGrid[x][y].flagged);\n    }\n\n    const hasWon = (grid) => grid.reduce((a, r) => a && r.reduce((a, c) => a && (c.isMine || !c.isCovered), true), true);\n\n    function handleLeftClick(cell) {\n        const [x, y] = [cell.x, cell.y];\n        props.cellGotClicked();\n\n        if (!grid[x][y].isCovered || grid[x][y].flagged || props.gameOver)\n            return;\n\n        if (grid[x][y].isMine) {\n            const newGrid = grid.map(r => r.map(c => ({\n                ...c,\n                isCovered: c.isMine ? false : c.isCovered\n            })));\n            newGrid[x][y].clickedMine = true;\n\n            setGrid(newGrid);\n            props.setGameEnd(gameStatuses.lost);\n        }\n        else  {\n            const newGrid = grid.map(r => r.map(c => ({\n                ...c\n            })));\n            newGrid[x][y].isCovered = false;\n            \n            if (grid[x][y].neighboringMines === 0) {\n                uncoverEmptyGrid(newGrid, cell);\n            }\n            else {\n                setGrid(newGrid);\n            }\n\n            if(hasWon(newGrid)) {\n                const flagsSetGrid = newGrid.map(r => r.map(c => ({\n                    ...c,\n                    flagged: c.isMine\n                })));\n                \n                setGrid(flagsSetGrid);\n                props.setGameEnd(gameStatuses.won);\n            }\n        }\n    }\n\n    // BFS\n    function uncoverEmptyGrid(grid, cell) {\n        const queue = [[cell.x, cell.y]];\n        let k = 0;\n        const length = grid.length;\n        const width = grid[0].length;\n\n        while (queue.length > 0) {\n            const n = queue.length;\n            for (let l = 0; l < n; l++) {\n                const [x, y] = queue.shift();\n\n                for (let i = Math.max(0, x - 1); i < Math.min(length, x + 2); ++i) {\n                    for (let j = Math.max(0, y - 1); j < Math.min(width, y + 2); ++j) {\n                        if (!grid[i][j].isMine && grid[i][j].isCovered && !grid[i][j].flagged) {\n                            grid[i][j].isCovered = false;\n                            if(grid[i][j].neighboringMines === 0) {\n                                queue.push([i, j]);\n                            }\n                        }\n                    }\n                }\n            }\n\n            // update after each breadth search cycle for animation\n            setTimeout((newGrid) => {\n                setGrid(newGrid);\n            }, k++ * 50, grid);\n        }\n    }\n\n    return (\n        grid.map((r, i) => <div key={i} className=\"row\">\n            {r.map((c, j) => <Cell\n                key={j}\n                data={c}\n                handleLeftClick={handleLeftClick}\n                handleRightClick={handleRightClick} />)}\n        </div>\n        )\n    );\n}\n","export function getNewGrid(length, width, minesCount) {\n\n    function getNewCells(length, width) {\n        let grid = [];\n        for (var i = 0; i < length; i++) {\n            grid[i] = [];\n            for (var j = 0; j < width; j++) {\n                grid[i][j] = {\n                    isMine: false\n                };\n            }\n        }\n\n        return grid;\n    }\n\n    function addMines(grid, minesCount) {\n        for (var i = 0; i < grid.length && minesCount; ++i) {\n            for (var j = 0; j < grid[i].length && minesCount; ++j, --minesCount) {\n                grid[i][j] = {\n                    isMine: true\n                };\n            }\n        }\n\n        return grid;\n    }\n\n    function randomize(grid) {\n        const n = grid.length;\n        const m = grid[0].length;\n        for (let i = 0; i < n; ++i) {\n            for (let j = 0; j < m; ++j) {\n                const rand = Math.floor(Math.random() * n * m);\n                const i1 = Math.floor(rand / m);\n                const j1 = rand % m;\n                [grid[i][j], grid[i1][j1]] = [grid[i1][j1], grid[i][j]];\n            }\n        }\n\n        return grid;\n    }\n\n    function setneighboringMines(mines) {\n\n        function calcNneighboringMines(x, y) {\n            var count = 0;\n\n            for (var i = Math.max(0, x - 1); i < Math.min(mines.length, x + 2); ++i) {\n                for (var j = Math.max(0, y - 1); j < Math.min(mines[i].length, y + 2); ++j) {\n                    if (mines[i][j].isMine) {\n                        count++;\n                    }\n                }\n            }\n\n            return count;\n        }\n\n        for (var i = 0; i < mines.length; ++i) {\n            for (var j = 0; j < mines[i].length; ++j) {\n                mines[i][j].neighboringMines = calcNneighboringMines(i, j);\n            }\n        }\n\n        return mines;\n    }\n\n    return setneighboringMines(randomize(addMines(getNewCells(length, width), minesCount)))\n        .map((r, i) => r.map((c, j) => ({\n            isCovered: true,\n            isMine: c.isMine,\n            neighboringMines: c.neighboringMines,\n            x: i,\n            y: j,\n        })));\n}\n","import React, { useEffect, useState } from 'react';\nimport { Scoreboard } from './Scoreboard';\nimport './Cell.component.css';\nimport './Minesweeper.component.css';\nimport { MinesweeperGrid } from './MinesweeperGrid';\nimport { getNewGrid } from './getNewGrid';\nimport { gameStatuses, levels } from '../constants';\nimport { useTimer } from '../hooks/useTimer';\n\n\nfunction Minesweeper() {\n    const [level, setLevel] = useState(levels[0]);\n\n    const [minesLeft, setMinesLeft] = useState(level.minesCount);\n    const [gameStatus, setGameStatus] = useState(gameStatuses.notStarted);\n    const [grid, setGrid] = useState(getNewGrid(level.height, level.width, level.minesCount));\n    const [refresh, setRefresh] = useState(false);\n    const [isClicking, setIsClicking] = useState(false);\n\n    const timer = useTimer(gameStatus === gameStatuses.running, gameStatus === gameStatuses.notStarted);\n\n    useEffect(reset, [level] );\n\n    function reset() {\n        setGameStatus(gameStatuses.notStarted);\n        setMinesLeft(level.minesCount);\n        setGrid(getNewGrid(level.height, level.width, level.minesCount));\n        setRefresh(refresh => !refresh);\n    }\n    \n    \n    const isGameOver = () => gameStatus === gameStatuses.won || gameStatus === gameStatuses.lost;\n\n    function cellGotFlagged(flagged) {\n        if(flagged) {\n            setMinesLeft(minesLeft-1);\n        }\n        else {\n            setMinesLeft(minesLeft+1);\n        }\n    }\n    \n    function cellGotClicked() {\n        if(gameStatus === gameStatuses.notStarted) {\n            setGameStatus(gameStatuses.running);\n        }\n    }\n\n    function setGameEnd(status) {\n        setGameStatus(status);\n        if (status === gameStatuses.won) {\n            setMinesLeft(0);\n        }\n    }\n\n    function levelChangeHandler(newLevelId) {\n        if(newLevelId !== level) {\n            setLevel(levels[newLevelId]);\n        }\n    }\n\n    return (\n        <div className=\"minesweeper\">\n            <Scoreboard \n                minesLeft={minesLeft}\n                timer={timer}\n                gameStatus={gameStatus}\n                level={level.id}\n                levelChangeHandler={levelChangeHandler}\n                isClicking={isClicking}\n                resetHandler={reset} />\n            <div className=\"grid\" onMouseDown={() => setIsClicking(true)} onMouseUp={() => setIsClicking(false)} onMouseLeave={() => setIsClicking(false)}>\n                <MinesweeperGrid\n                    refresh={refresh}\n                    grid={grid}\n                    gameOver={isGameOver()}\n                    cellGotFlagged={cellGotFlagged}\n                    cellGotClicked={cellGotClicked}\n                    setGameEnd={setGameEnd} />\n            </div>\n        </div>\n    );\n}\n\nexport default Minesweeper;\n\n","import { useState, useEffect } from 'react';\n\nexport function useTimer(isActive, reset) {\n    const [timer, setTimer] = useState(0);\n\n    useEffect(() => {\n        let interval = null;\n        if (isActive && !interval) {\n            interval = setTimeout(() => {\n                setTimer(timer => timer + 1);\n            }, 1000);\n        } else if (interval) {\n            clearTimeout(interval);\n        }\n\n        if (reset) {\n            setTimer(0);\n        }\n\n        return () => clearTimeout(interval);\n    }, [timer, isActive, reset]);\n\n    return timer;\n}\n","import './App.css';\nimport Minesweeper from './components/Minesweeper';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Minesweeper />\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals(console.log);\n"],"sourceRoot":""}